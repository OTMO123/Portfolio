<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert Cloud to Transparent PNG</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #0a0a0a;
            color: white;
            font-family: Arial, sans-serif;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        canvas {
            border: 2px solid #84FE8E;
            border-radius: 10px;
            margin: 20px;
            background: repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 20px 20px;
        }
        
        button {
            background: #84FE8E;
            color: #0a0a0a;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
        }
        
        .status {
            color: #84FE8E;
            font-weight: bold;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Convert Neo Cloud to Transparent PNG</h1>
        
        <div class="status" id="status">Loading original image...</div>
        
        <div>
            <h3>Original Image:</h3>
            <canvas id="original-canvas" width="400" height="300"></canvas>
        </div>
        
        <div>
            <h3>Transparent Version:</h3>
            <canvas id="transparent-canvas" width="400" height="300"></canvas>
        </div>
        
        <button onclick="downloadTransparent()">Download Transparent PNG</button>
        <button onclick="testAnimation()">Test in Animation</button>
        
        <div id="test-area" style="position: relative; height: 200px; background: #1a1a1a; border-radius: 10px; margin-top: 20px; overflow: hidden;">
            <div id="test-cloud" style="
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 200px;
                height: 140px;
                background-image: url('main_cloude_transparent.png');
                background-size: contain;
                background-repeat: no-repeat;
                background-position: center;
                opacity: 0.6;
                animation: test-float 5s ease-in-out infinite;
            "></div>
        </div>
    </div>

    <style>
        @keyframes test-float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0); }
            50% { transform: translate(-50%, -50%) translateY(-20px); }
        }
    </style>

    <script>
        const originalCanvas = document.getElementById('original-canvas');
        const transparentCanvas = document.getElementById('transparent-canvas');
        const originalCtx = originalCanvas.getContext('2d');
        const transparentCtx = transparentCanvas.getContext('2d');
        const status = document.getElementById('status');
        
        // Load and process the cloud image
        const img = new Image();
        img.onload = function() {
            status.textContent = 'Processing image...';
            
            // Set canvas size to match image proportions
            const aspectRatio = img.width / img.height;
            let canvasWidth = 400;
            let canvasHeight = 400 / aspectRatio;
            
            // Adjust if height is too big
            if (canvasHeight > 300) {
                canvasHeight = 300;
                canvasWidth = 300 * aspectRatio;
            }
            
            originalCanvas.width = canvasWidth;
            originalCanvas.height = canvasHeight;
            transparentCanvas.width = canvasWidth;
            transparentCanvas.height = canvasHeight;
            
            // Draw original with correct proportions
            originalCtx.drawImage(img, 0, 0, canvasWidth, canvasHeight);
            
            // Get image data with correct dimensions
            const imageData = originalCtx.getImageData(0, 0, canvasWidth, canvasHeight);
            const data = imageData.data;
            
            // Process pixels to remove black background
            for (let i = 0; i < data.length; i += 4) {
                const r = data[i];
                const g = data[i + 1];
                const b = data[i + 2];
                
                // If pixel is dark (close to black), make it transparent
                const brightness = (r + g + b) / 3;
                if (brightness < 50) {
                    data[i + 3] = 0; // Make transparent
                } else {
                    // Keep the pixel but enhance green tones
                    data[i + 3] = 255; // Keep opaque
                }
            }
            
            // Draw processed image
            transparentCtx.putImageData(imageData, 0, 0);
            
            console.log(`Cloud dimensions: ${img.width}x${img.height}, Canvas: ${canvasWidth}x${canvasHeight}`);
            
            // Create transparent PNG data URL
            const transparentDataURL = transparentCanvas.toDataURL('image/png');
            
            // Create downloadable blob
            transparentCanvas.toBlob(function(blob) {
                window.transparentBlob = blob;
                status.textContent = '✅ Transparent cloud ready!';
            }, 'image/png');
        };
        
        img.onerror = function() {
            status.textContent = '❌ Failed to load cloud image';
        };
        
        img.src = 'main_cloude.jpg';
        
        function downloadTransparent() {
            if (window.transparentBlob) {
                const url = URL.createObjectURL(window.transparentBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'main_cloude_transparent.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                status.textContent = '✅ Downloaded! Now use main_cloude_transparent.png in your portfolio';
            }
        }
        
        function testAnimation() {
            const testCloud = document.getElementById('test-cloud');
            testCloud.style.backgroundImage = "url('" + transparentCanvas.toDataURL('image/png') + "')";
            status.textContent = 'Testing animation with transparent cloud...';
        }
    </script>
</body>
</html>